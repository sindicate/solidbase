#summary Getting Started with the SolidBase Ant task.

You should first read [GettingStartedCommandLineWithArguments Getting Started with SolidBase on the command-line]. That one contains details that are assumed knowledge in this Getting Started.

To start using !SolidBase's Ant task, put solidbase.jar in a folder, for example C:\TEMP. Get the driver jar for your database and put it in the same folder.

Create the upgrade script for the database named test-upgrade.sql:

{{{
--*	DEFINITION
--*		INIT "" --> "1.1"
--*		UPGRADE "" --> "1.0.1"
--*		UPGRADE "1.0.1" --> "1.0.2"
--*	/DEFINITION



--* INIT "" --> "1.1"

--* SET MESSAGE "    Creating table DBVERSION"

CREATE TABLE DBVERSION
(
	SPEC VARCHAR(5),
	VERSION VARCHAR(20), 
	TARGET VARCHAR(20), 
	STATEMENTS DECIMAL(4) NOT NULL
)
GO

--* SET MESSAGE "    Creating table DBVERSIONLOG"

CREATE TABLE DBVERSIONLOG
(
	TYPE VARCHAR(1) NOT NULL,
	SOURCE VARCHAR(20),
	TARGET VARCHAR(20) NOT NULL,
	STATEMENT DECIMAL(4) NOT NULL,
	STAMP TIMESTAMP NOT NULL,
	COMMAND VARCHAR(4000),
	RESULT VARCHAR(4000)
)
GO

CREATE INDEX DBVERSIONLOG_INDEX1 ON DBVERSIONLOG ( TYPE, TARGET )
GO

--* /INIT



--* UPGRADE "" --> "1.0.1"

--* SET MESSAGE "    Creating table USERS"

CREATE TABLE USERS
(
	USER_ID INT NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
	USER_USERNAME VARCHAR(26) NOT NULL,
	USER_PASSWORD VARCHAR(30) NOT NULL
)
GO

--* /UPGRADE



--* UPGRADE "1.0.1" --> "1.0.2"

--* SET MESSAGE "    Inserting admin user"

INSERT INTO USERS ( USER_USERNAME, USER_PASSWORD ) VALUES ( 'admin', '*****' )
GO

--* SET MESSAGE "    Inserting user"

INSERT INTO USERS ( USER_USERNAME, USER_PASSWORD ) VALUES ( 'ren√©', '*****' )
GO

--* /UPGRADE
}}}

Create the build.xml:

{{{
<?xml version="1.0" encoding="UTF-8"?>

<project basedir=".">

	<taskdef resource="solidbasetasks" classpath="solidbase.jar;derby-10.2.1.6.jar" />

	<target name="upgradedb">
		<solidbase-upgrade driver="org.apache.derby.jdbc.EmbeddedDriver" url="jdbc:derby:testant;create=true" 
			username="app" password="" 
			upgradefile="test-upgrade.sql" target="1.0.*" />
	</target>

</project>
}}}

The taskdef element also adds the driver jar to the classpath to make it available to !SolidBase.

The folder now looks like:

{{{
C:\TEMP>dir
 Volume in drive C has no label.
 Volume Serial Number is FAA5-5622

 Directory of C:\TEMP

02/17/2010  08:59 PM    <DIR>          .
02/17/2010  08:59 PM    <DIR>          ..
02/17/2010  09:01 PM               388 build.xml
11/01/2009  09:13 PM         2,253,277 derby-10.2.1.6.jar
02/14/2010  10:35 PM           249,540 solidbase.jar
02/14/2010  10:11 PM             1,286 test-upgrade.sql
               4 File(s)      2,504,491 bytes
               2 Dir(s)  33,678,532,608 bytes free

C:\TEMP>
}}}

Run the following command:

{{{
ant upgradedb
}}}

You get the following output:

{{{
C:\TEMP>ant upgradedb
Buildfile: build.xml

upgradedb:
[solidbase-upgrade] SolidBase v1.5.1-rev317
[solidbase-upgrade] (C) 2006-2010 Rene M. de Bloois
[solidbase-upgrade]
[solidbase-upgrade] Connecting to database...
[solidbase-upgrade] The database has no version yet.
[solidbase-upgrade] Opening file 'C:\TEMP\test-upgrade.sql'
[solidbase-upgrade]     Encoding is 'ISO-8859-1'
[solidbase-upgrade] Initializing to "1.1"
[solidbase-upgrade]     Creating table DBVERSION.
[solidbase-upgrade]     Creating table DBVERSIONLOG..
[solidbase-upgrade] Upgrading to "1.0.1"
[solidbase-upgrade]     Creating table USERS.
[solidbase-upgrade] Upgrading "1.0.1" to "1.0.2"
[solidbase-upgrade]     Inserting admin user.
[solidbase-upgrade]     Inserting user.
[solidbase-upgrade] The database is upgraded.
[solidbase-upgrade]
[solidbase-upgrade] Current database version is "1.0.2".

BUILD SUCCESSFUL
Total time: 7 seconds
C:\TEMP>
}}}

This concludes the Getting Started with the Ant task.

Have a happy time playing with !SolidBase!