#summary Getting Started with SolidBase using a properties file.

This Getting Started is generated by scripts/!GenerateGettingStarted.groovy

(Use !SolidBase 1.6.5 or newer.)

You should first read [GettingStartedCommandLineWithArguments Getting Started with SolidBase on the command-line]. That one contains details that are assumed knowledge in this Getting Started.

To start using !SolidBase with a properties file, put solidbase.jar in a folder of your choosing. Get the driver jar for your database and put it in the same folder.

Create the upgrade script for the database named test-upgrade.sql:

{{{
--* DEFINITION
--*     SETUP "" --> "1.1"
--*     UPGRADE "" --> "1.0.1"
--*     UPGRADE "1.0.1" --> "1.0.2"
--* /DEFINITION



--* SETUP "" --> "1.1"

--* SECTION "Creating SolidBase control tables"

CREATE TABLE DBVERSION
(
    SPEC VARCHAR(5),
    VERSION VARCHAR(20),
    TARGET VARCHAR(20),
    STATEMENTS DECIMAL(4) NOT NULL
);

CREATE TABLE DBVERSIONLOG
(
    TYPE VARCHAR(1) NOT NULL,
    SOURCE VARCHAR(20),
    TARGET VARCHAR(20) NOT NULL,
    STATEMENT DECIMAL(4) NOT NULL,
    STAMP TIMESTAMP NOT NULL,
    COMMAND VARCHAR(4000),
    RESULT VARCHAR(4000)
);

CREATE INDEX DBVERSIONLOG_INDEX1 ON DBVERSIONLOG ( TYPE, TARGET );

--* /SETUP



--* UPGRADE "" --> "1.0.1"

--* SECTION "Creating table USERS"
CREATE TABLE USERS
(
    USER_ID INT NOT NULL GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    USER_USERNAME VARCHAR(26) NOT NULL,
    USER_PASSWORD VARCHAR(30) NOT NULL
);

--* /UPGRADE



--* UPGRADE "1.0.1" --> "1.0.2"

--* SECTION "Inserting admin user"
INSERT INTO USERS ( USER_USERNAME, USER_PASSWORD ) VALUES ( 'admin', '*****' );

--* SECTION "Inserting user"
INSERT INTO USERS ( USER_USERNAME, USER_PASSWORD ) VALUES ( 'rene', '*****' );

--* /UPGRADE
}}}

You can find example upgrade scripts for Oracle, MySQL, Derby/JavaDB and HSQLDB/HyperSQL [http://code.google.com/p/solidbase/source/browse/trunk#trunk/dist here]. 

Create a solidbase.properties file:

{{{
properties-version = 1.0

# add jars to the classpath
classpath.ext = derby-10.5.3.0.jar

# upgrade file & upgrade target
upgrade.file = test-upgrade.sql
upgrade.target = 1.0.*

# primary connection
connection.driver = org.apache.derby.jdbc.EmbeddedDriver
connection.url = jdbc:derby:testant;create=true
connection.username = app
}}}

The folder now looks like:

{{{
G:\PROJECTS\BUILDS\solidbase\TEMP>dir
 Volume in drive G is WIN7
 Volume Serial Number is FAA5-5622

 Directory of G:\PROJECTS\BUILDS\solidbase\TEMP

07/25/2011  06:46 PM    <DIR>          .
07/25/2011  06:46 PM    <DIR>          ..
10/23/2010  10:44 PM         2,512,189 derby-10.5.3.0.jar
07/25/2011  06:46 PM           283,084 solidbase.jar
07/25/2011  06:46 PM               330 solidbase.properties
07/25/2011  06:46 PM             1,178 test-upgrade.sql
               4 File(s)      2,796,781 bytes
               2 Dir(s)   5,300,281,344 bytes free

G:\PROJECTS\BUILDS\solidbase\TEMP>
}}}

Run the following command (press enter when asked for the password):

{{{
java -jar solidbase.jar
}}}

You get the following output:

{{{
G:\PROJECTS\BUILDS\solidbase\TEMP>java -jar solidbase.jar
7/25/11 6:46 PM   SolidBase v1.6.5-rev635 (http://solidbase.org)
7/25/11 6:46 PM   
7/25/11 6:46 PM   Opening file \
     'G:\PROJECTS\BUILDS\solidbase\TEMP\test-upgrade.sql'
7/25/11 6:46 PM       Encoding is 'ISO-8859-1'
7/25/11 6:46 PM   Connecting to database...
7/25/11 6:46 PM   Input password for user 'app': 7/25/11 6:46 PM   The database \
     is unmanaged.
7/25/11 6:46 PM   Setting up control tables to "1.1"
7/25/11 6:46 PM       Creating SolidBase control tables...
7/25/11 6:46 PM   Upgrading to "1.0.1"
7/25/11 6:46 PM       Creating table USERS.
7/25/11 6:46 PM   Upgrading "1.0.1" to "1.0.2"
7/25/11 6:46 PM       Inserting admin user.
7/25/11 6:46 PM       Inserting user.
7/25/11 6:46 PM   The database is upgraded.
7/25/11 6:46 PM   
7/25/11 6:46 PM   Current database version is "1.0.2".

G:\PROJECTS\BUILDS\solidbase\TEMP>
}}}

This concludes the Getting Started with a properties file.

Enjoy!
